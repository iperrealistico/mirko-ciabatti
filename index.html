<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Mirko Ciabatti | Cinematographer & Director of Photography (DOP) in Milan, Italy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Portfolio website of Italian cinematographer and director of photography (DOP) Mirko Ciabatti, based in Milan, Italy. Cinematography for films, fashion, commercials and music videos.">
  <meta name="robots" content="index,follow">
  <meta name="author" content="Mirko Ciabatti">

  <!-- Canonical -->
  <link rel="canonical" href="https://www.mirkociabatti.com/">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Mirko Ciabatti Cinematographer">
  <meta property="og:title" content="Mirko Ciabatti | Cinematographer & Director of Photography (DOP) in Milan, Italy">
  <meta property="og:description" content="Official portfolio of Italian cinematographer and director of photography (DOP) Mirko Ciabatti. Selected works for films, fashion, commercials, music videos and documentaries.">
  <meta property="og:url" content="https://www.mirkociabatti.com/">
  <!-- Placeholder image, change with your cover -->
  <meta property="og:image" content="https://www.mirkociabatti.com/cover.jpg">

  <!-- Twitter Cards -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Mirko Ciabatti | Cinematographer & Director of Photography (DOP) in Milan, Italy">
  <meta name="twitter:description" content="Official portfolio of cinematographer and director of photography Mirko Ciabatti. Selected cinematography work shot in Italy and worldwide.">
  <meta name="twitter:image" content="https://www.mirkociabatti.com/cover.jpg">

  <!-- Performance hints -->
  <link rel="preconnect" href="https://vimeo.com" crossorigin>
  <link rel="preconnect" href="https://i.vimeocdn.com" crossorigin>
  <link rel="preconnect" href="https://www.youtube.com" crossorigin>
  <link rel="preconnect" href="https://i.ytimg.com" crossorigin>
  <meta name="theme-color" content="#000000">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">

  <!-- Schema.org Person -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "Mirko Ciabatti",
    "jobTitle": "Cinematographer and Director of Photography (DOP)",
    "alternateName": [
      "Direttore della fotografia",
      "Cinematographer",
      "Director of Photography"
    ],
    "url": "https://www.mirkociabatti.com/",
    "sameAs": [
      "https://vimeo.com/mirkociabatti",
      "https://www.instagram.com/mirko_ciabatti/?hl=en"
    ],
    "nationality": "Italian",
    "knowsLanguage": ["it", "en"],
    "description": "Portfolio website of Italian cinematographer and director of photography (DOP) Mirko Ciabatti, based in Milan, Italy. He works on films, fashion, commercials, music videos and documentaries with a strong focus on light, composition and camera movement.",
    "knowsAbout": [
      "cinematography",
      "commercials",
      "music videos",
      "documentaries",
      "lighting",
      "camera movement"
    ]
  }
  </script>

  <style>
    :root {
      color-scheme: dark;
      --bg-color: #000000;
      --text-color: #f5f5f5;
      --accent-color: #ffffff;
      --muted-color: #aaaaaa;
      --card-bg: #111111;
      --border-color: #222222;
      --focus-outline: #ffffff;
      --max-width: 1100px;
      --transition-speed: 0.18s;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
      scroll-behavior: smooth;
      background-color: #000000;
    }

    body {
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      -webkit-font-smoothing: antialiased;
    }

    body.body--no-scroll {
      overflow: hidden;
    }

    a {
      color: var(--accent-color);
      text-decoration: none;
    }

    a:hover,
    a:focus-visible {
      text-decoration: none;
    }

    .site {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .site__inner {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 1.5rem 1.25rem 2rem;
    }

    header.hero {
      padding-top: 2.5rem;
      padding-bottom: 2rem;
    }

    .hero__eyebrow {
      font-family: "Space Grotesk", system-ui, sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      font-size: 0.75rem;
      color: var(--muted-color);
      margin-bottom: 0.75rem;
    }

    .hero__title {
      font-family: "Space Grotesk", system-ui, sans-serif;
      font-size: clamp(2.2rem, 4.4vw, 2.8rem);
      font-weight: 600;
      margin-bottom: 0.4rem;
    }

    .hero__subtitle {
      font-size: 1rem;
      color: var(--muted-color);
      margin-bottom: 1.5rem;
    }

    .hero__text {
      max-width: 40rem;
      font-size: 0.98rem;
      line-height: 1.6;
      margin-bottom: 1.25rem;
      white-space: pre-line; /* preserve line breaks in the intro text */
    }

    .hero__text + .hero__text {
      margin-top: 0.5rem;
    }

    .hero__links {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin-top: 1rem;
    }

    .hero__link {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.4rem 0.9rem;
      border-radius: 999px;
      border: 1px solid var(--border-color);
      font-size: 0.86rem;
      text-decoration: none;
      background: rgba(255, 255, 255, 0.02);
      transition: border-color var(--transition-speed) ease, background-color var(--transition-speed) ease, transform var(--transition-speed) ease;
      white-space: nowrap;
    }

    .hero__link-icon {
      font-size: 0.85rem;
    }

    .hero__link:hover,
    .hero__link:focus-visible {
      border-color: var(--accent-color);
      background: rgba(255, 255, 255, 0.06);
      text-decoration: none;
      transform: translateY(-1px);
    }

    .hero__link-label {
      text-transform: uppercase;
      letter-spacing: 0.12em;
      font-size: 0.7rem;
      color: var(--muted-color);
    }

    .hero__link-slash {
      opacity: 0.8;
    }

    main {
      flex: 1;
    }

    section {
      padding: 1.5rem 0;
    }

    .section__header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 1rem;
      margin-bottom: 1.25rem;
    }

    .section__title {
      font-family: "Space Grotesk", system-ui, sans-serif;
      font-size: 1.1rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
    }

    .section__description {
      font-size: 0.9rem;
      color: var(--muted-color);
      max-width: 24rem;
    }

    .videos-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    @media (min-width: 640px) {
      .videos-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (min-width: 1024px) {
      .videos-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .video-card {
      background-color: var(--card-bg);
      border-radius: 0.75rem;
      overflow: hidden;
      border: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      min-height: 0;
      transition: transform var(--transition-speed) ease, border-color var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
    }

    .video-card__link {
      display: flex;
      flex-direction: column;
      flex: 1;
      text-decoration: none;
      color: inherit;
    }

    .video-card__link:hover,
    .video-card__link:focus-visible {
      text-decoration: none;
    }

    .video-card:hover,
    .video-card:focus-within {
      transform: translateY(-2px);
      border-color: var(--accent-color);
      box-shadow: 0 14px 30px rgba(0, 0, 0, 0.7);
    }

    .video-card__thumb {
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;
      overflow: hidden;
      background: #000000;
    }

    .video-card__thumb[data-loading="true"] {
      animation: thumbPulse 1.4s ease-in-out infinite;
    }

    @keyframes thumbPulse {
      0% { opacity: 0.7; }
      50% { opacity: 1; }
      100% { opacity: 0.7; }
    }

    .video-card__thumb img {
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
      opacity: 0;
      transition: opacity 0.25s ease-out;
      background-color: #000000;
    }

    .video-card__thumb[data-loading="false"] img {
      opacity: 1;
    }

    .video-card__body {
      padding: 0.8rem 0.85rem 0.9rem;
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    .video-card__title {
      font-size: 0.96rem;
      font-weight: 500;
      line-height: 1.4;
    }

    .video-card__meta {
      font-size: 0.78rem;
      color: var(--muted-color);
      text-transform: uppercase;
      letter-spacing: 0.16em;
    }

    .video-card__skeleton {
      background: linear-gradient(90deg, #1a1a1a 0%, #222222 40%, #1a1a1a 80%);
      background-size: 200% 100%;
      animation: shimmer 1.3s infinite linear;
      width: 70%;
      height: 0.8rem;
      border-radius: 999px;
      margin-top: 0.2rem;
    }

    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }

    .videos-grid__message {
      font-size: 0.9rem;
      color: var(--muted-color);
      margin-top: 0.5rem;
    }

    .contact {
      border-top: 1px solid var(--border-color);
      margin-top: 2.5rem;
      padding-top: 1.5rem;
      font-size: 0.9rem;
      color: var(--muted-color);
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem 1.5rem;
    }

    .contact__item-label {
      text-transform: uppercase;
      letter-spacing: 0.16em;
      font-size: 0.72rem;
      color: var(--muted-color);
    }

    .contact__item-value {
      font-size: 0.9rem;
    }

    footer.site-footer {
      border-top: 1px solid var(--border-color);
      padding: 0.8rem 1.25rem;
      font-size: 0.75rem;
      color: var(--muted-color);
    }

    .site-footer__inner {
      max-width: var(--max-width);
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.5rem;
    }

    .site-footer__right {
      text-align: right;
      font-variant-numeric: tabular-nums;
    }

    .site-footer__right i {
      margin-right: 0.35rem;
    }

    .skip-link {
      position: absolute;
      left: -999px;
      top: auto;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }

    .skip-link:focus-visible {
      position: static;
      width: auto;
      height: auto;
      padding: 0.4rem 0.7rem;
      margin: 0.5rem 0;
      background: #ffffff;
      color: #000000;
      border-radius: 999px;
      outline: none;
      z-index: 100;
    }

    :focus-visible {
      outline: 2px solid var(--focus-outline);
      outline-offset: 3px;
    }

    /* Lightbox */

    .lightbox {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.25s ease-out;
      background: transparent;
    }

    .lightbox--active {
      pointer-events: auto;
      opacity: 1;
    }

    .lightbox__overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.96);
      backdrop-filter: blur(2px);
    }

    .lightbox__dialog {
      position: relative;
      max-width: 1100px;
      width: 100%;
      margin: 0 1.25rem;
      z-index: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      outline: none;
    }

    .lightbox__inner {
      position: relative;
      width: 100%;
      background: #000000;
      border-radius: 0.75rem;
      border: 1px solid #333333;
      padding: 0.75rem 0.75rem 0.85rem;
      box-shadow: 0 28px 60px rgba(0, 0, 0, 0.9);
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
      transform: translateY(12px);
      opacity: 0;
      transition: opacity 0.25s ease-out, transform 0.25s ease-out;
    }

    .lightbox--active .lightbox__inner {
      opacity: 1;
      transform: translateY(0);
    }

    .lightbox__player-wrapper {
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;
      background: #000000;
      overflow: hidden;
      border-radius: 0.6rem;
    }

    .lightbox__player-wrapper iframe {
      width: 100%;
      height: 100%;
      border: 0;
      display: block;
      background-color: #000000;
    }

    .lightbox__meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.85rem;
      color: var(--muted-color);
      flex-wrap: wrap;
    }

    .lightbox__title {
      font-size: 0.95rem;
      font-weight: 500;
      max-width: 75%;
    }

    .lightbox__open-vimeo {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      font-size: 0.8rem;
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
      border: 1px solid #333333;
      background: transparent;
      text-decoration: none;
      transition: background-color var(--transition-speed) ease, border-color var(--transition-speed) ease, transform var(--transition-speed) ease;
    }

    .lightbox__open-vimeo i {
      font-size: 0.9rem;
    }

    .lightbox__open-vimeo:hover,
    .lightbox__open-vimeo:focus-visible {
      border-color: var(--accent-color);
      background: rgba(255, 255, 255, 0.06);
      transform: translateY(-1px);
    }

    .lightbox__close {
      position: absolute;
      right: 0.75rem;
      top: 0.75rem;
      z-index: 2;
      width: 2rem;
      height: 2rem;
      border-radius: 999px;
      border: 1px solid #333333;
      background: rgba(0, 0, 0, 0.8);
      color: #f5f5f5;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background-color var(--transition-speed) ease, border-color var(--transition-speed) ease, transform var(--transition-speed) ease;
    }

    .lightbox__close i {
      font-size: 1rem;
    }

    .lightbox__close:hover,
    .lightbox__close:focus-visible {
      border-color: var(--accent-color);
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-1px);
    }

    .lightbox__nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      z-index: 2;
      width: 2.4rem;
      height: 2.4rem;
      border-radius: 999px;
      border: 1px solid #333333;
      background: rgba(0, 0, 0, 0.8);
      color: #f5f5f5;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background-color var(--transition-speed) ease, border-color var(--transition-speed) ease, transform var(--transition-speed) ease, opacity var(--transition-speed) ease;
    }

    .lightbox__nav--prev {
      left: 0.25rem;
    }

    .lightbox__nav--next {
      right: 0.25rem;
    }

    .lightbox__nav i {
      font-size: 1rem;
    }

    .lightbox__nav:hover,
    .lightbox__nav:focus-visible {
      border-color: var(--accent-color);
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(calc(-50% - 1px));
    }

    .lightbox__nav--disabled {
      opacity: 0.2;
      pointer-events: none;
    }

    @media (max-width: 640px) {
      .lightbox__inner {
        padding: 0.65rem;
      }
      .lightbox__title {
        max-width: 100%;
      }
      .lightbox__nav {
        width: 2.1rem;
        height: 2.1rem;
      }
      .lightbox__nav--prev {
        left: 0.2rem;
      }
      .lightbox__nav--next {
        right: 0.2rem;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        scroll-behavior: auto;
        animation-duration: 0.001ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.001ms !important;
      }
    }

    /* Load animation */

    .animate-on-load {
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.35s ease-out, transform 0.35s ease-out;
    }

    body.is-loaded .animate-on-load {
      opacity: 1;
      transform: translateY(0);
    }

    body.is-loaded header.hero.animate-on-load {
      transition-delay: 0.05s;
    }

    body.is-loaded #work .section__header.animate-on-load {
      transition-delay: 0.12s;
    }

    body.is-loaded .videos-grid.animate-on-load {
      transition-delay: 0.16s;
    }

    body.is-loaded .contact.animate-on-load {
      transition-delay: 0.2s;
    }
  </style>
</head>
<body class="site">
  <div class="site__inner">
    <a href="#work" class="skip-link" id="skip-link">Skip to selected work</a>

    <!-- ========= EDITABLE TEXT CONTENT (ENGLISH) - YOU CAN EDIT EVERYTHING UNTIL THE NEXT DIVIDER ========= -->

    <header class="hero animate-on-load">
      <div class="hero__eyebrow" id="hero-eyebrow">Italian cinematographer and DOP</div>
      <h1 class="hero__title" id="hero-title">Mirko Ciabatti Cinematographer</h1>
      <p class="hero__subtitle" id="hero-subtitle">
        Italian cinematographer and director of photography (DOP) based in Milan, Italy, working across films, fashion, commercials and music videos.
      </p>

      <p class="hero__text">
Nice to meet you!
I’m a cinematographer working across film, fashion, commercials, and music videos.
Based in Milan and available worldwide.
I combine creative vision with technical expertise to craft visuals that tell stories and emotionally engage the audience.
Let’s connect and see where it takes us.
      </p>

      <div class="hero__links">
        <a class="hero__link" href="https://vimeo.com/mirkociabatti" target="_blank" rel="noopener noreferrer me" aria-label="Vimeo portfolio of cinematographer and director of photography Mirko Ciabatti">
          <i class="fa-brands fa-vimeo-v hero__link-icon" aria-hidden="true"></i>
          <span class="hero__link-label" id="hero-link-vimeo-label">Portfolio</span>
          <span class="hero__link-slash" id="hero-link-vimeo-suffix">/ Vimeo</span>
        </a>
        <a class="hero__link" href="https://www.instagram.com/mirko_ciabatti/?hl=en" target="_blank" rel="noopener noreferrer me" aria-label="Instagram profile of cinematographer Mirko Ciabatti">
          <i class="fa-brands fa-instagram hero__link-icon" aria-hidden="true"></i>
          <span class="hero__link-label" id="hero-link-ig-label">Stills</span>
          <span class="hero__link-slash" id="hero-link-ig-suffix">/ Instagram</span>
        </a>
      </div>
    </header>

    <main>
      <section id="work" aria-labelledby="work-title">
        <div class="section__header animate-on-load">
          <h2 class="section__title" id="work-title">Selected works</h2>
          <p class="section__description" id="work-description">
            A curated selection of cinematography work by Italian cinematographer and director of photography Mirko Ciabatti, including films, fashion films, commercials, music videos and documentary projects shot in Italy and worldwide.
          </p>
        </div>

        <div id="videos-grid" class="videos-grid animate-on-load" aria-live="polite">
          <!-- Video cards injected by JavaScript -->
        </div>
        <p id="videos-message" class="videos-grid__message" role="status" aria-live="polite" data-state=""></p>
      </section>

      <section aria-label="Contacts and base">
        <div class="contact animate-on-load">
          <div class="contact__item">
            <div class="contact__item-label" id="contact-label">Get in touch</div>
            <div class="contact__item-value">
              <a href="mailto:contact@mirkociabatti.com">contact@mirkociabatti.com</a>
            </div>
          </div>
          <div class="contact__item">
            <div class="contact__item-label" id="base-label">Where</div>
            <div class="contact__item-value" id="base-value">
              Italy-based, available worldwide
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- ========= END OF EDITABLE TEXT CONTENT - DO NOT EDIT BELOW THIS LINE ========= -->
  </div>

  <!-- Lightbox (Vimeo / YouTube) -->
  <div id="lightbox" class="lightbox" aria-hidden="true">
    <div class="lightbox__overlay" data-lightbox-overlay></div>
    <div class="lightbox__dialog" role="dialog" aria-modal="true" aria-label="Video player">
      <div class="lightbox__inner">
        <button type="button" class="lightbox__close" id="lightbox-close" aria-label="Close video">
          <i class="fa-solid fa-xmark" aria-hidden="true"></i>
        </button>
        <button type="button" class="lightbox__nav lightbox__nav--prev" id="lightbox-prev" aria-label="Previous video">
          <i class="fa-solid fa-chevron-left" aria-hidden="true"></i>
        </button>
        <button type="button" class="lightbox__nav lightbox__nav--next" id="lightbox-next" aria-label="Next video">
          <i class="fa-solid fa-chevron-right" aria-hidden="true"></i>
        </button>

        <div class="lightbox__player-wrapper" id="lightbox-player-wrapper">
          <!-- Video iframe injected here -->
        </div>

        <div class="lightbox__meta">
          <h3 class="lightbox__title" id="lightbox-title">Video title</h3>
          <a class="lightbox__open-vimeo" id="lightbox-open-vimeo" href="#" target="_blank" rel="noopener">
            <i class="fa-brands fa-vimeo-v" aria-hidden="true"></i>
            <span>Open on Vimeo</span>
          </a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="site-footer__inner">
      <div>
        © <span id="year"></span> Mirko Ciabatti. All third-party video content, trademarks and logos remain the property of their respective legal owners.
      </div>
      <div class="site-footer__right">
        <i class="fa-solid fa-cookie-bite" aria-hidden="true"></i>
        Embedded Vimeo and YouTube video players may set cookies strictly necessary for video playback.
      </div>
    </div>
  </footer>

  <script>
    // Footer year
    document.getElementById("year").textContent = new Date().getFullYear();

    const VIDEOS_EMPTY_MESSAGE = "No videos found. Add Vimeo or YouTube URLs in videos.txt, one per line.";
    const VIDEOS_ERROR_MESSAGE = "Error loading videos. Check that videos.txt is present next to index.html.";
    const VIDEO_ALT_TEXT = "Cinematography work by Italian cinematographer and director of photography Mirko Ciabatti.";

    const videosGrid = document.getElementById("videos-grid");
    const videosMessage = document.getElementById("videos-message");

    let videoItems = [];
    let lightboxEl, lightboxDialog, lightboxPlayerWrapper, lightboxTitle, lightboxOpenVimeo;
    let lightboxCloseBtn, lightboxPrevBtn, lightboxNextBtn;
    let currentVideoIndex = -1;
    let lastFocusedElement = null;
    let lightboxKeydownHandler;
    let touchStartX = null;
    let touchStartY = null;

    function createVideoCardSkeleton(videoUrl, provider) {
      const card = document.createElement("article");
      card.className = "video-card";

      const link = document.createElement("a");
      link.className = "video-card__link";
      link.href = videoUrl;
      link.target = "_blank";
      link.rel = "noopener noreferrer";

      const thumb = document.createElement("div");
      thumb.className = "video-card__thumb";
      thumb.dataset.loading = "true";

      const img = document.createElement("img");
      img.loading = "lazy";
      img.decoding = "async";
      img.alt = VIDEO_ALT_TEXT;
      thumb.appendChild(img);

      const body = document.createElement("div");
      body.className = "video-card__body";

      const title = document.createElement("h3");
      title.className = "video-card__title";
      title.textContent = "Loading title";

      const meta = document.createElement("div");
      meta.className = "video-card__meta";
      if (provider === "youtube") {
        meta.textContent = "PLAY ON YOUTUBE";
      } else if (provider === "vimeo") {
        meta.textContent = "PLAY ON VIMEO";
      } else {
        meta.textContent = "PLAY";
      }

      const skeleton = document.createElement("div");
      skeleton.className = "video-card__skeleton";

      body.appendChild(title);
      body.appendChild(meta);
      body.appendChild(skeleton);

      link.appendChild(thumb);
      link.appendChild(body);
      card.appendChild(link);

      img.addEventListener("load", () => {
        thumb.dataset.loading = "false";
      });

      img.addEventListener("error", () => {
        thumb.dataset.loading = "false";
      });

      return { card, img, title, meta, skeleton, thumb, link };
    }

    function extractVimeoId(urlString) {
      try {
        const url = new URL(urlString);
        const segments = url.pathname.split("/").filter(Boolean);
        if (!segments.length) return null;
        return segments[segments.length - 1];
      } catch (e) {
        return null;
      }
    }

    function detectProvider(urlString) {
      try {
        const url = new URL(urlString);
        const host = url.hostname.toLowerCase();
        if (host.includes("vimeo.com")) return "vimeo";
        if (host.includes("youtube.com") || host.includes("youtu.be") || host.includes("youtube-nocookie.com")) return "youtube";
        return null;
      } catch (e) {
        return null;
      }
    }

    function extractYouTubeId(urlString) {
      try {
        const url = new URL(urlString);
        const host = url.hostname.toLowerCase();
        if (host === "youtu.be") {
          const segments = url.pathname.split("/").filter(Boolean);
          return segments[0] || null;
        }
        if (host.includes("youtube.com") || host.includes("youtube-nocookie.com")) {
          const vParam = url.searchParams.get("v");
          if (vParam) return vParam;
          const segments = url.pathname.split("/").filter(Boolean);
          const embedIndex = segments.indexOf("embed");
          if (embedIndex !== -1 && segments[embedIndex + 1]) {
            return segments[embedIndex + 1];
          }
        }
        return null;
      } catch (e) {
        return null;
      }
    }

    async function loadVideos() {
      try {
        const response = await fetch("videos.txt", { cache: "no-cache" });
        if (!response.ok) {
          throw new Error("Cannot read videos.txt");
        }
        const text = await response.text();
        const lines = text
          .split(/\r?\n/)
          .map(line => line.trim())
          .filter(line => line.length && !line.startsWith("#"));

        if (!lines.length) {
          videosMessage.dataset.state = "empty";
          videosMessage.textContent = VIDEOS_EMPTY_MESSAGE;
          return;
        }

        videosMessage.dataset.state = "";
        videosMessage.textContent = "";

        videoItems = [];

        lines.forEach((videoUrl, index) => {
          const provider = detectProvider(videoUrl) || "vimeo";
          const vimeoId = provider === "vimeo" ? extractVimeoId(videoUrl) : null;
          const youtubeId = provider === "youtube" ? extractYouTubeId(videoUrl) : null;

          const { card, img, title, meta, skeleton, thumb, link } = createVideoCardSkeleton(videoUrl, provider);
          videosGrid.appendChild(card);

          videoItems.push({
            url: videoUrl,
            provider,
            vimeoId,
            youtubeId,
            img,
            titleElement: title,
            meta,
            skeleton,
            thumb,
            link,
            videoTitle: null
          });

          link.dataset.videoIndex = String(index);
          link.addEventListener("click", (event) => {
            event.preventDefault();
            openLightbox(index);
          });
        });

        // Populate data via oEmbed
        for (let i = 0; i < videoItems.length; i++) {
          const item = videoItems[i];

          if (item.provider === "vimeo") {
            const oembedApi = "https://vimeo.com/api/oembed.json?url=" + encodeURIComponent(item.url);
            try {
              const oembedResponse = await fetch(oembedApi);
              if (!oembedResponse.ok) {
                throw new Error("oEmbed error");
              }
              const data = await oembedResponse.json();

              if (data.thumbnail_url) {
                item.img.src = data.thumbnail_url;
              } else {
                item.img.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1600' height='900'%3E%3Crect width='100%25' height='100%25' fill='%23000000'/%3E%3C/svg%3E";
              }

              if (data.title) {
                item.titleElement.textContent = data.title;
                item.videoTitle = data.title;
              } else {
                item.titleElement.textContent = "Video on Vimeo";
                item.videoTitle = "Video on Vimeo";
              }

              item.meta.textContent = "PLAY ON VIMEO" + (data.duration ? " · " + Math.round(data.duration) + "s" : "");
              item.skeleton.remove();
            } catch (error) {
              item.img.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1600' height='900'%3E%3Crect width='100%25' height='100%25' fill='%23000000'/%3E%3C/svg%3E";
              item.titleElement.textContent = "Video on Vimeo";
              item.videoTitle = "Video on Vimeo";
              item.meta.textContent = "PLAY ON VIMEO";
              item.skeleton.remove();
            }
          } else if (item.provider === "youtube") {
            const oembedApi = "https://www.youtube.com/oembed?url=" + encodeURIComponent(item.url) + "&format=json";
            try {
              const oembedResponse = await fetch(oembedApi);
              if (!oembedResponse.ok) {
                throw new Error("YouTube oEmbed error");
              }
              const data = await oembedResponse.json();

              if (data.thumbnail_url) {
                item.img.src = data.thumbnail_url;
              } else if (item.youtubeId) {
                item.img.src = "https://img.youtube.com/vi/" + encodeURIComponent(item.youtubeId) + "/hqdefault.jpg";
              } else {
                item.img.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1600' height='900'%3E%3Crect width='100%25' height='100%25' fill='%23000000'/%3E%3C/svg%3E";
              }

              if (data.title) {
                item.titleElement.textContent = data.title;
                item.videoTitle = data.title;
              } else {
                item.titleElement.textContent = "YouTube video";
                item.videoTitle = "YouTube video";
              }

              item.meta.textContent = "PLAY ON YOUTUBE";
              item.skeleton.remove();
            } catch (error) {
              if (item.youtubeId) {
                item.img.src = "https://img.youtube.com/vi/" + encodeURIComponent(item.youtubeId) + "/hqdefault.jpg";
              } else {
                item.img.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1600' height='900'%3E%3Crect width='100%25' height='100%25' fill='%23000000'/%3E%3C/svg%3E";
              }
              item.titleElement.textContent = "YouTube video";
              item.videoTitle = "YouTube video";
              item.meta.textContent = "PLAY ON YOUTUBE";
              item.skeleton.remove();
            }
          } else {
            // Unknown provider: fallback
            item.img.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1600' height='900'%3E%3Crect width='100%25' height='100%25' fill='%23000000'/%3E%3C/svg%3E";
            item.titleElement.textContent = "Video";
            item.videoTitle = "Video";
            item.meta.textContent = "PLAY";
            item.skeleton.remove();
          }
        }

        updateLightboxNavState();
      } catch (error) {
        videosMessage.dataset.state = "error";
        videosMessage.textContent = VIDEOS_ERROR_MESSAGE;
      }
    }

    // Lightbox logic

    function initLightbox() {
      lightboxEl = document.getElementById("lightbox");
      lightboxDialog = lightboxEl.querySelector(".lightbox__dialog");
      lightboxPlayerWrapper = document.getElementById("lightbox-player-wrapper");
      lightboxTitle = document.getElementById("lightbox-title");
      lightboxOpenVimeo = document.getElementById("lightbox-open-vimeo");
      lightboxCloseBtn = document.getElementById("lightbox-close");
      lightboxPrevBtn = document.getElementById("lightbox-prev");
      lightboxNextBtn = document.getElementById("lightbox-next");

      const overlay = lightboxEl.querySelector("[data-lightbox-overlay]");

      overlay.addEventListener("click", closeLightbox);
      lightboxCloseBtn.addEventListener("click", closeLightbox);

      lightboxPrevBtn.addEventListener("click", () => {
        navigateLightbox(-1);
      });

      lightboxNextBtn.addEventListener("click", () => {
        navigateLightbox(1);
      });

      lightboxKeydownHandler = function (event) {
        if (!lightboxEl.classList.contains("lightbox--active")) return;

        if (event.key === "Escape") {
          event.preventDefault();
          closeLightbox();
        } else if (event.key === "ArrowRight") {
          event.preventDefault();
          navigateLightbox(1);
        } else if (event.key === "ArrowLeft") {
          event.preventDefault();
          navigateLightbox(-1);
        } else if (event.key === "Tab") {
          trapFocus(event);
        }
      };

      lightboxDialog.addEventListener("touchstart", handleTouchStart, { passive: true });
      lightboxDialog.addEventListener("touchmove", handleTouchMove, { passive: true });
      lightboxDialog.addEventListener("touchend", handleTouchEnd, { passive: true });
    }

    function openLightbox(index) {
      if (!lightboxEl || !videoItems.length) return;
      if (index < 0 || index >= videoItems.length) return;

      currentVideoIndex = index;

      if (!lightboxEl.classList.contains("lightbox--active")) {
        lightboxEl.classList.add("lightbox--active");
        lightboxEl.setAttribute("aria-hidden", "false");
        document.body.classList.add("body--no-scroll");
        lastFocusedElement = document.activeElement;
        document.addEventListener("keydown", lightboxKeydownHandler);
        lightboxCloseBtn.focus();
      }

      loadLightboxVideo(index);
      updateLightboxNavState();
    }

    function closeLightbox() {
      if (!lightboxEl) return;
      lightboxEl.classList.remove("lightbox--active");
      lightboxEl.setAttribute("aria-hidden", "true");
      document.body.classList.remove("body--no-scroll");
      document.removeEventListener("keydown", lightboxKeydownHandler);
      currentVideoIndex = -1;

      if (lightboxPlayerWrapper) {
        lightboxPlayerWrapper.innerHTML = "";
      }

      if (lastFocusedElement && typeof lastFocusedElement.focus === "function") {
        lastFocusedElement.focus();
      }
    }

    function loadLightboxVideo(index) {
      const item = videoItems[index];
      if (!item) return;

      let src = "";
      const provider = item.provider || "vimeo";

      if (provider === "youtube") {
        const ytId = item.youtubeId || extractYouTubeId(item.url);
        if (!ytId) return;
        src = "https://www.youtube.com/embed/" + encodeURIComponent(ytId) + "?autoplay=1&rel=0&modestbranding=1&playsinline=1";
      } else {
        const vimeoId = item.vimeoId || extractVimeoId(item.url);
        if (!vimeoId) return;
        const baseUrl = "https://player.vimeo.com/video/" + encodeURIComponent(vimeoId);
        const params = "?autoplay=1&title=0&byline=0&portrait=0";
        src = baseUrl + params;
      }

      lightboxPlayerWrapper.innerHTML = "";
      const iframe = document.createElement("iframe");
      iframe.src = src;
      if (provider === "youtube") {
        iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
      } else {
        iframe.allow = "autoplay; fullscreen; picture-in-picture";
      }
      iframe.allowFullscreen = true;
      iframe.setAttribute("title", item.videoTitle || (provider === "youtube" ? "YouTube video" : "Vimeo video"));
      lightboxPlayerWrapper.appendChild(iframe);

      lightboxTitle.textContent = item.videoTitle || (provider === "youtube" ? "YouTube video" : "Vimeo video");
      lightboxOpenVimeo.href = item.url;

      const icon = lightboxOpenVimeo.querySelector("i");
      const labelSpan = lightboxOpenVimeo.querySelector("span");
      if (provider === "youtube") {
        if (icon) {
          icon.className = "fa-brands fa-youtube";
        }
        if (labelSpan) {
          labelSpan.textContent = "Open on YouTube";
        }
      } else {
        if (icon) {
          icon.className = "fa-brands fa-vimeo-v";
        }
        if (labelSpan) {
          labelSpan.textContent = "Open on Vimeo";
        }
      }
    }

    function navigateLightbox(direction) {
      if (currentVideoIndex === -1) return;
      const newIndex = currentVideoIndex + direction;
      if (newIndex < 0 || newIndex >= videoItems.length) return;
      currentVideoIndex = newIndex;
      loadLightboxVideo(newIndex);
      updateLightboxNavState();
    }

    function updateLightboxNavState() {
      if (!lightboxPrevBtn || !lightboxNextBtn) return;
      if (videoItems.length <= 1) {
        lightboxPrevBtn.classList.add("lightbox__nav--disabled");
        lightboxNextBtn.classList.add("lightbox__nav--disabled");
        return;
      }
      if (currentVideoIndex <= 0) {
        lightboxPrevBtn.classList.add("lightbox__nav--disabled");
      } else {
        lightboxPrevBtn.classList.remove("lightbox__nav--disabled");
      }
      if (currentVideoIndex >= videoItems.length - 1) {
function updateLightboxNavState() {
      if (!lightboxPrevBtn || !lightboxNextBtn) return;
      if (videoItems.length <= 1) {
        lightboxPrevBtn.classList.add("lightbox__nav--disabled");
        lightboxNextBtn.classList.add("lightbox__nav--disabled");
        return;
      }
      if (currentVideoIndex <= 0) {
        lightboxPrevBtn.classList.add("lightbox__nav--disabled");
      } else {
        lightboxPrevBtn.classList.remove("lightbox__nav--disabled");
      }
      if (currentVideoIndex >= videoItems.length - 1) {
        lightboxNextBtn.classList.add("lightbox__nav--disabled");
      } else {
        lightboxNextBtn.classList.remove("lightbox__nav--disabled");
      }
    }

    function trapFocus(event) {
      const focusableSelectors = [
        "button:not([disabled])",
        "a[href]",
        "[tabindex]:not([tabindex='-1'])"
      ];
      const focusable = lightboxDialog.querySelectorAll(focusableSelectors.join(","));
      const focusableArray = Array.prototype.slice.call(focusable)
        .filter(el => el.offsetParent !== null);

      if (focusableArray.length === 0) return;

      const first = focusableArray[0];
      const last = focusableArray[focusableArray.length - 1];

      if (event.shiftKey && document.activeElement === first) {
        event.preventDefault();
        last.focus();
      } else if (!event.shiftKey && document.activeElement === last) {
        event.preventDefault();
        first.focus();
      }
    }

    function handleTouchStart(event) {
      if (!event.touches || event.touches.length !== 1) return;
      const touch = event.touches[0];
      touchStartX = touch.clientX;
      touchStartY = touch.clientY;
    }

    function handleTouchMove(event) {
      // intentionally left blank
    }

    function handleTouchEnd(event) {
      if (touchStartX === null || touchStartY === null) {
        return;
      }

      const touch = event.changedTouches && event.changedTouches[0];
      if (!touch) return;

      const dx = touch.clientX - touchStartX;
      const dy = touch.clientY - touchStartY;

      const absDx = Math.abs(dx);
      const absDy = Math.abs(dy);

      const swipeThreshold = 40;

      if (absDx > swipeThreshold && absDx > absDy) {
        if (dx < 0) {
          navigateLightbox(1);
        } else {
          navigateLightbox(-1);
        }
      }

      touchStartX = null;
      touchStartY = null;
    }

    document.addEventListener("DOMContentLoaded", () => {
      document.body.classList.add("is-loaded");
      initLightbox();
      loadVideos();
    });
  </script>
</body>
</html>
